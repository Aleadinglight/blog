---
import Base from "./Base.astro";
import TableOfContents from "../components/TableOfContents.astro";
// Get props for the blog post
const { title, description, pubDate, updatedDate, heroImage, tags, headings = [] } = Astro.props;

// Format dates
const formattedPubDate = pubDate.toLocaleDateString('en-us', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});

const formattedUpdatedDate = updatedDate && updatedDate.toLocaleDateString('en-us', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<Base title={title}>
  <div class="max-w-6xl mx-auto px-4 py-6">
    <div class="md:grid md:grid-cols-4 md:gap-8">
      <!-- Main content area -->
      <div class="md:col-span-3">
        <article class="prose lg:prose-xl prose-img:rounded-xl max-w-none">
          <div class="mb-8">
            {heroImage && (
              <div class="mb-6">
                <img 
                  src={heroImage} 
                  alt={title}
                  class="w-full h-64 sm:h-96 object-cover rounded-lg shadow-md" 
                />
              </div>
            )}
            
            <h1 class="text-4xl font-bold mb-2 text-gray-900">{title}</h1>
            
            {description && (
              <p class="text-xl text-gray-600 mb-4">{description}</p>
            )}
            
            <div class="flex items-center text-gray-500 text-sm mb-6">
              <time datetime={pubDate.toISOString()}>{formattedPubDate}</time>
              {formattedUpdatedDate && (
                <span class="ml-4">
                  Last updated: <time datetime={updatedDate.toISOString()}>{formattedUpdatedDate}</time>
                </span>
              )}
            </div>
            
            {tags && tags.length > 0 && (
              <div class="flex flex-wrap gap-2 mb-6">
                {tags.map((tag:string) => (
                  <span class="inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10">
                    {tag}
                  </span>
                ))}
              </div>
            )}
            
            <!-- Mobile TOC appears after tags but before content -->
            <div class="md:hidden mb-6">
              <TableOfContents headings={headings} />
            </div>
          </div>
          
          <div class="blog-content">
            <slot />
          </div>
        </article>
      </div>
      
      <!-- Desktop TOC - shows on md screens and above -->
      <div class="hidden md:block md:col-span-1 sticky top-20">
        <TableOfContents headings={headings} />
      </div>
    </div>
  </div>
</Base>